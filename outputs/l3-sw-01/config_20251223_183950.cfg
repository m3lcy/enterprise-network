

hostname l3-sw-01

enable secret cisco_l3_01

username admin privilege 15 secret cisco_l3_admin01

banner motd zAuthorized Access Only!!!z

service password-encryption

ip domain-name cisco.com

crypto key generate rsa usage-keys label ssh-key modulus 1024

ip routing

line vty 0 4
  password vty_l3_01
   login local
   transport input ssh
   access-class MGMT_VTY_ACL in
 
vlan 10
 name CORE
vlan 20
 name MGMT
vlan 30
 name COMPUTE
vlan 99
 name NATIVE
vlan 100
 name R&D
vlan 200
 name EMPLOYEE
vlan 300
 name GUEST
vlan 999
 name BLACKHOLE


spanning-tree mode pvst
spanning-tree vlan 10,20,30,100,200,300 priority 24576

interface Loopback0

  description LOOPBACK - SSH
 
 
  
  ip address 172.16.255.2 255.255.255.255
 
  no shutdown
 
 
 
 
 
   interface FastEthernet0/1

  description TRUNK TO access-sw-02 fa0/1
 
   switchport trunk encapsulation dot1q
 switchport mode trunk
  
  switchport trunk native vlan 99
  
 
  no shutdown
 
 
 
 
 
   interface FastEthernet0/2

  description TRUNK TO l3-sw-02 fa0/2
 
   switchport trunk encapsulation dot1q
 switchport mode trunk
  
  
 
  no shutdown
 
 
 
 
 
   interface FastEthernet0/3

  description TRUNK TO l3-sw-03 fa0/3
 
   switchport trunk encapsulation dot1q
 switchport mode trunk
  
  
 
  no shutdown
 
 
 
 
 
   interface FastEthernet0/5

  description TRUNK TO access-sw-03 g0/1
 
   switchport trunk encapsulation dot1q
 switchport mode trunk
  
  switchport trunk native vlan 99
  
 
  no shutdown
 
 
 
 
 
   service-policy input VLAN30_POLICY
  interface FastEthernet0/6

  description TRUNK TO access-sw-04 fa0/1
 
   switchport trunk encapsulation dot1q
 switchport mode trunk
  
  switchport trunk native vlan 99
  
 
  no shutdown
 
 
 
 
 
   interface FastEthernet0/4

  description SPARE / RESERVED FOR FUTURE USE
 
   switchport mode access
  
   switchport access vlan 999
 
 
  shutdown
 
 
 
 
 
   interface range FastEthernet0/7-24

  description SPARE / RESERVED FOR FUTURE USE
 
   switchport mode access
  
   switchport access vlan 999
 
 
  shutdown
 
 
 
 
 
   interface GigabitEthernet0/1

  description UPLINK TO core-r1 g0/0
 
   no switchport
  
  
  ip address 172.16.12.225 255.255.255.252
 
  no shutdown
 
 
 
 
 
   interface GigabitEthernet0/2

  description TRUNK TO access-sw-01 g0/1
 
   switchport trunk encapsulation dot1q
 switchport mode trunk
  
  switchport trunk native vlan 99
  
 
  no shutdown
 
 
 
 
 
   interface VLAN1

 
 
  
 
  shutdown
 
 
 
 
 
   interface VLAN10

  description VLAN10 COMPUTE
 
 
  
  ip address 172.16.12.1 255.255.255.224
 
  no shutdown
 
 
  ip helper-address 172.16.12.226
 
 
   standby 1 ip 172.16.12.254
   standby version 2
   standby 1 priority 150
   standby 1 preempt
  
   interface VLAN20

  description VLAN20 MANAGEMENT
 
 
  
  ip address 172.16.12.33 255.255.255.224
 
  no shutdown
 
 
  ip helper-address 172.16.12.226
 
 
   standby 1 ip 172.16.12.254
   standby version 2
   standby 1 priority 150
   standby 1 preempt
  
   interface VLAN30

  description VLAN30 COMPUTE
 
 
  
  ip address 172.16.12.65 255.255.255.224
 
  no shutdown
 
 
  ip helper-address 172.16.12.226
 
 
   standby 1 ip 172.16.12.254
   standby version 2
   standby 1 priority 150
   standby 1 preempt
  
    service-policy output VLAN30_POLICY
 interface VLAN99

  description NATIVE VLAN
 
 
  
  ip address 172.16.12.97 255.255.255.224
 
  no shutdown
 
 
  ip helper-address 172.16.12.226
 
 
   standby 1 ip 172.16.12.254
   standby version 2
   standby 1 priority 150
   standby 1 preempt
  
   interface VLAN100

  description VLAN100 R&D
 
 
  
  ip address 172.16.12.129 255.255.255.224
 
  no shutdown
 
 
  ip helper-address 172.16.12.226
 
 
 
   interface VLAN200

  description VLAN200 EMPLOYEE
 
 
  
  ip address 172.16.12.161 255.255.255.224
 
  no shutdown
 
 
  ip helper-address 172.16.12.226
 
 
 
   interface VLAN300

  description VLAN300 GUEST
 
 
  
  ip address 172.16.12.193 255.255.255.224
 
  no shutdown
 
 
  ip helper-address 172.16.12.226
 
 
 
   

router ospf 1
 router-id 2.2.2.2
  passive-interface default
    no passive-interface GigabitEthernet0/1
     network 172.16.12.0 0.0.0.31 area 0
  network 172.16.12.32 0.0.0.31 area 0
  network 172.16.12.64 0.0.0.31 area 0
  network 172.16.12.96 0.0.0.31 area 0
  network 172.16.12.128 0.0.0.31 area 0
  network 172.16.12.160 0.0.0.31 area 0
  network 172.16.12.192 0.0.0.31 area 0
  network 172.16.12.224 0.0.0.31 area 0
  network 172.16.12.225 0.0.0.3 area 0
 



ip access-list extended MGMT_VTY_ACL
  remark RESTRICT SSH MANAGEMENT ACCESS
   remark ONLY ALLOW FROM MANAGEMENT VLAN 20
   permit tcp 172.16.12.32 0.0.0.31 any eq 22
   remark ALLOW OTHER TRAFFIC
   permit ip any  any 
 
ip default-gateway 172.16.12.98
end

write memory
